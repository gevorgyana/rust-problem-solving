Solution is described in code.